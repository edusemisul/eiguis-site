<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Entrar — EÍGUIS</title>
  <link rel="icon" href="/favicon.ico">
  <link href="https://unpkg.com/@fontsource/inter@5.0.8/variable.css" rel="stylesheet">
  <style>
    :root{color-scheme:dark light}
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:"InterVariable",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Ubuntu,"Helvetica Neue",Arial,"Apple Color Emoji","Segoe UI Emoji",sans-serif;background:radial-gradient(1200px 700px at 10% -10%,#0f172a 0%,#0b1022 40%,#070b17 70%,#050812 100%) no-repeat center fixed;color:#e5e7eb}
    .wrap{min-height:100%;display:grid;place-items:center;padding:24px}
    .card{width:100%;max-width:420px;background:rgba(15,23,42,.6);backdrop-filter: blur(10px);border:1px solid rgba(148,163,184,.16);border-radius:18px;box-shadow:0 10px 40px rgba(0,0,0,.55);padding:28px}
    h1{font-size:28px;line-height:1.1;margin:0 0 8px;font-weight:800;letter-spacing:.2px}
    .sub{font-size:13px;color:#94a3b8;margin:0 0 20px}
    label{display:block;font-size:13px;color:#cbd5e1;margin:14px 0 8px}
    input{width:100%;background:#0b1222;border:1px solid #1f2a44;border-radius:12px;padding:14px 14px;color:#e5e7eb;font-size:15px;outline:none;transition:.2s}
    input:focus{border-color:#facc15;box-shadow:0 0 0 3px rgba(250,204,21,.15)}
    .btn{width:100%;border:0;border-radius:12px;padding:14px 16px;margin-top:18px;font-weight:700;font-size:15px;background:linear-gradient(180deg,#f8d54a 0%,#e5b800 100%);color:#1a1a1a;cursor:pointer;transition:.2s}
    .btn:hover{transform:translateY(-1px);filter:saturate(110%)}
    .err{margin-top:12px;font-size:13px;color:#fda4af}
    .muted{margin-top:14px;font-size:12px;color:#93a2b6;text-align:center}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
        <div style="width:36px;height:36px;border-radius:10px;background:#facc15;color:#111;display:grid;place-items:center;font-weight:900">Ei</div>
        <div>
          <div style="font-weight:800;letter-spacing:.2px">EÍGUIS • Inteligência Investigativa</div>
          <div style="font-size:12px;color:#93a2b6">Acesso seguro ao ambiente do investigador</div>
        </div>
      </div>

      <h1>Entrar</h1>
      <p class="sub">Use seu e-mail e senha cadastrados.</p>

      <label for="email">E-mail</label>
      <input id="email" type="email" placeholder="seu@email.com" autocomplete="email" />

      <label for="password">Senha</label>
      <input id="password" type="password" placeholder="••••••••" autocomplete="current-password" />

      <button id="loginBtn" class="btn">Acessar</button>
      <div id="err" class="err" style="display:none"></div>
      <div class="muted">Protegido por trilha de auditoria e política de acesso.</div>
    </div>
  </div>

  <script type="module">
    // ====== JÁ CONFIGURADO PARA O SEU PROJETO ======
    const SUPABASE_URL = 'https://bsdleapswwzyeeknsxyj.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJzZGxlYXBzd3d6eWVla25zeHlqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5NDcwNzAsImV4cCI6MjA3NzUyMzA3MH0.wlnWWRLuBPGs7F9na-IyDozuXz_L4MmtnT7JHVjXFXo';
    // ================================================

    import { createClient } from 'https://esm.sh/@supabase/supabase-js@2';

    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
      auth: { persistSession: true, autoRefreshToken: true, detectSessionInUrl: true }
    });

    // Se já tiver sessão, vai para o painel
    const { data: { session } } = await supabase.auth.getSession();
    if (session) location.href = '/painel.html';

    const $ = (id) => document.getElementById(id);
    const emailEl = $('email');
    const passEl  = $('password');
    const errEl   = $('err');
    const btn     = $('loginBtn');

    btn.addEventListener('click', async () => {
      errEl.style.display = 'none'; errEl.textContent = '';
      btn.disabled = true; btn.textContent = 'Entrando...';
      try {
        const { error } = await supabase.auth.signInWithPassword({
          email: emailEl.value.trim(),
          password: passEl.value
        });
        if (error) throw error;
        location.href = '/painel.html';
      } catch (e) {
        errEl.textContent = (e?.message || 'Falha ao entrar.').replace('fetch', 'conectar');
        errEl.style.display = 'block';
      } finally {
        btn.disabled = false; btn.textContent = 'Acessar';
      }
    });

    [emailEl, passEl].forEach(el => el.addEventListener('keydown', e => {
      if (e.key === 'Enter') btn.click();
    }));
  </script>
</body>
</html>
